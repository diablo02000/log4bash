---
name: Unit-tests

on:
  pull_request:
    branches: [master, main]
    paths:
      - '**/*.sh'
      - '**/*.bats'
      - '**/*.bash'
      - 'github/workflows/unit-tests.yml'

permissions: read-all

jobs:
   bats:
     runs-on: ubuntu-latest
     name: Install Bats and bats libs
     steps:
       - name: Checkout
         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
         with:
           persist-credentials: false
       - name: Setup Bats and bats libs
         id: setup-bats
         uses: bats-core/bats-action@42fcc8700f773c075a16a90eb11674c0318ad507 # v3.0.1
         with:
           support-path: ${{ github.workspace }}/tests/test_helper/bats-support
           assert-path: "${{ github.workspace }}/tests/test_helper/bats-assert"
       - name: Bats tests
         shell: bash
         env:
           BATS_LIB_PATH: ${{ steps.setup-bats.outputs.lib-path }}
           TERM: xterm
         run: bats tests/
